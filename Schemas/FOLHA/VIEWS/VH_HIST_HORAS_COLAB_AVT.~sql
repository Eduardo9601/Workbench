CREATE OR REPLACE VIEW VH_HIST_HORAS_COLAB_AVT AS
SELECT DISTINCT B.COD_CONTRATO,
                B.DATA_INICIO AS DATA_INI_HR,
                B.DATA_FIM AS DATA_FIM_HR,
                B.COD_HORAS_BASE,
                /*RHFP0321.QTD_HORBAS_MES,
                              RHFP0321.QTD_HORBAS_SEM,
                              RHFP0321.QTD_HORBAS_DIA,*/
                LTRIM(RTRIM(TRIM(TRAILING '.' FROM
                                 TRIM(TRAILING '0' FROM
                                      TO_CHAR(A.QTD_HORBAS_MES,
                                              '9999999990.99'))))) AS HR_BASE_MES,
                LTRIM(RTRIM(TRIM(TRAILING '.' FROM
                                 TRIM(TRAILING '0' FROM
                                      TO_CHAR(A.QTD_HORBAS_SEM,
                                              '9999999990.99'))))) AS HR_BASE_SEM,
                LTRIM(RTRIM(TRIM(TRAILING '.' FROM
                                 TRIM(TRAILING '0' FROM
                                      TO_CHAR(A.QTD_HORBAS_DIA,
                                              '9999999990.99'))))) AS HR_BASE_DIA,
                B.COD_MOTIVO,
                C.NOME_MOTIVO AS DES_MOTIVO,
                C.COD_TIPO_MOTIVO,
                D.NOME_TIPO_MOTIVO AS DES_TIPO_MOTIVO,
                CASE
                  WHEN E.COD_TURNO IN (2, 85) THEN
                   'N'
                  ELSE
                   'S'
                END AS IND_BATE_PONTO
  FROM RHFP0321 A, RHFP0307 B, RHFP0323 C, RHFP0115 D, RHAF1119 E
 WHERE B.COD_HORAS_BASE = A.COD_HORAS_BASE(+)
   AND B.COD_MOTIVO = C.COD_MOTIVO(+)
   AND C.COD_TIPO_MOTIVO = D.COD_TIPO_MOTIVO(+)
   AND B.COD_CONTRATO = E.COD_CONTRATO(+)
   AND B.COD_CONTRATO = 389622
 ORDER BY B.DATA_INICIO