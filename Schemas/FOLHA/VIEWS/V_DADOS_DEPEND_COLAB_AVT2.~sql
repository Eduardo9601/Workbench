CREATE OR REPLACE VIEW V_DADOS_DEPEND_COLAB_AVT2 AS
SELECT --DADOS DEPENDENTE
       D.COD_PESSOA AS COD_PESSOA_DEPEND,
       D.CPF AS CPF_DEPEND,
       E.NOME_PESSOA AS DES_DEPEND,
       F.COD_GRAU_PARENTESCO AS COD_GRAU_PARENT,
       F.NOME_GRAU_PARENTESCO AS DES_GRAU_PARENT,
       C.DATA_NASCIMENTO AS DTA_NASC_DEPEND,
       D.MATRICULA_NASC AS MATRICULA_NASC_DEPEND,
       D.NRO_CARTAO_SUS AS NRO_CARTAO_SUS_DEPEND,
       C.SEXO AS SEXO_DEPEND,
       TRUNC(MONTHS_BETWEEN(SYSDATE, C.DATA_NASCIMENTO) / 12) AS IDADE_DEPEND,
       C.COD_UF_NASCIMENTO,
       C.COD_MUNIC_NASCIMENTO,
       C.COD_CARTORIO,
       C.NRO_REGISTRO,
       C.NRO_LIVRO,
       C.NRO_FOLHA,
       D.CPF,
       C.NRO_IDENTIDADE,
       F.COD_ESOCIAL,
       C.IRF,
       C.SAL_FAMILIA,
       C.COD_PESSOA_MAE,
       H.NOME_PESSOA AS NOME_MAE,
       C.COD_ESTADO_CIVIL,
       C.DATA_OBITO,
       --DADOS COLABORADOR
       A.COD_PESSOA AS COD_PESSOA_COLAB,
       G.COD_CONTRATO,
       G.DATA_INICIO AS DATA_ADMISSAO,
       G.DATA_FIM AS DATA_DEMISSAO,
       A.CPF AS CPF_COLAB,
       B.NOME_PESSOA AS DES_COLAB       
  FROM FISICA   A,
       PESSOA   B,
       RHFP0202 C,
       FISICA   D,
       PESSOA   E,
       RHFP0106 F,
       RHFP0300 G,
       PESSOA   H

 WHERE A.COD_PESSOA = C.COD_FUNC
   AND C.COD_PESSOA = D.COD_PESSOA
   AND F.COD_GRAU_PARENTESCO = C.COD_GRAU_PARENTESCO
   AND G.COD_FUNC = A.COD_PESSOA
   AND A.COD_PESSOA = B.COD_PESSOA
   AND D.COD_PESSOA = E.COD_PESSOA
   AND C.COD_PESSOA_MAE = H.COD_PESSOA(+)
   --AND G.DATA_FIM IS NULL
  /* AND (C.DATA_FIM IS NULL OR
        C.DATA_FIM > SYSDATE)*/
;
