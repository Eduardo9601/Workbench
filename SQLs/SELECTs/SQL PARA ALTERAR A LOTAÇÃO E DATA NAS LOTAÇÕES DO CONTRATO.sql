----PROCEDIMENTO PARA ALTERAR A LOTAÇÃO DE GERENTES 
-----EM QUE NA SUAS LOJAS POSSUI MAIS DE 1 GERENTE

--=======SELECT========--

SELECT COD_CONTRATO,
       CASE
          WHEN COD_CONTRATO = 390967 THEN '15/07/2021'
          WHEN COD_CONTRATO = 382184 THEN '08/08/2012'
          WHEN COD_CONTRATO = 387620 THEN '20/03/2018'
          WHEN COD_CONTRATO = 387788 THEN '15/05/2018'
          WHEN COD_CONTRATO = 387302 THEN '08/11/2017'
          ELSE NULL
       END AS NOVA_DATA_INICIO,
       DATA_INICIO,
       DATA_FIM,
       CASE
          WHEN COD_CONTRATO = 390967 THEN 937
          WHEN COD_CONTRATO = 382184 THEN 938
          WHEN COD_CONTRATO = 387620 THEN 939
          WHEN COD_CONTRATO = 387788 THEN 940
          WHEN COD_CONTRATO = 387302 THEN 936
          ELSE NULL
       END AS NOVA_LOTACAO,
       COD_LOTACAO,
       IND_TITULAR,
       COD_MOTIVO
FROM RHFP0309
WHERE COD_CONTRATO IN (390967, 382184, 387620, 387788, 387302);

--======UPDATE=======--

UPDATE RHFP0309
SET 
  COD_LOTACAO = 
    CASE
      WHEN COD_CONTRATO = 390967 THEN 937
      WHEN COD_CONTRATO = 382184 THEN 938
      WHEN COD_CONTRATO = 387620 THEN 939
      WHEN COD_CONTRATO = 387788 THEN 940
      WHEN COD_CONTRATO = 387302 THEN 936
      ELSE COD_LOTACAO
    END,
  DATA_INICIO = 
    CASE
      WHEN COD_CONTRATO = 390967 THEN TO_DATE('15/07/2021', 'DD/MM/YYYY')
      WHEN COD_CONTRATO = 382184 THEN TO_DATE('08/08/2012', 'DD/MM/YYYY')
      WHEN COD_CONTRATO = 387620 THEN TO_DATE('20/03/2018', 'DD/MM/YYYY')
      WHEN COD_CONTRATO = 387788 THEN TO_DATE('15/05/2018', 'DD/MM/YYYY')
      WHEN COD_CONTRATO = 387302 THEN TO_DATE('08/11/2017', 'DD/MM/YYYY')
      ELSE DATA_INICIO
    END
WHERE COD_CONTRATO IN (390967, 382184, 387620, 387788, 387302);