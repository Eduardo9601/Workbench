--SQL PAI ORIGINAL PARA GERAR AS HORAS

SELECT RHAF1123.COD_CONTRATO,
       RHAF1123.ORIGEM,
       RHAF1123.DATA_OCORRENCIA,
       RHAF1123.COD_SEQ_OCORRENCIA,
       RHAF1123.COD_OCORRENCIA,
       RHAF1123.DIA_REF_ENT,
       RHAF1123.DIA_REF_SAI,
       RHAF1123.HORA_ENT,
       RHAF1123.HORA_SAI,
       RHAF1123.IND_OCO_AUTORIZADA,
       RHAF1123.NUM_HORAS,
       RHAF1123.COD_MOTIVO_OCO,
       RHAF1123.COD_PROGRAMACAO,
       RHAF1108.COD_CRACHA,
       RHAF1138.NOME_MOTIVO_OCO,
       RHAF1129.NOME_OCORRENCIA,
       RHAF1129.TIPO_DADOS,
       RHAF1129.TIPO_OCORRENCIA,
       RHAF1129.IND_SISTEMA,
       (TRIM(TO_CHAR(RHYF0118(RHAF1123.NUM_HORAS),'990,00'))) AS NUM_HORAS_HM
  FROM RHAF1123 RHAF1123,
       RHAF1129 RHAF1129,
       RHAF1138 RHAF1138,
       RHAF1108 RHAF1108
 WHERE RHAF1123.COD_OCORRENCIA  = RHAF1129.COD_OCORRENCIA
   AND RHAF1123.COD_CONTRATO    = RHAF1108.COD_CONTRATO(+)
   AND RHAF1123.DATA_OCORRENCIA BETWEEN :DATA_INICIO AND :DATA_FIM
   AND RHAF1123.DATA_OCORRENCIA BETWEEN RHAF1108.DATA_INICIO AND RHAF1108.DATA_FIM
   AND RHAF1129.COD_MOTIVO_OCO  = RHAF1138.COD_MOTIVO_OCO(+)


--==============================================================================================================--
--==============================================================================================================--
--==============================================================================================================--

--FORMULÁRIO DE IRREGULARIDADE +2HRS EXTRAS

SELECT DISTINCT RHAF1123.COD_CONTRATO,
                VDP.DES_PESSOA,
                RHFP0401.EDICAO_ORG,
                RHFP0400.NOME_ORGANOGRAMA,
                VDP.COD_GRUPO,
                VDP.DES_GRUPO,
                RHAF1129.COD_OCORRENCIA,
                RHAF1129.NOME_OCORRENCIA,
                TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MONTH') AS NOME_MES,
                TRIM(TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'Month')) || '/'
                || TO_CHAR(RHAF1123.DATA_OCORRENCIA,'YYYY') AS MES_OCORRENCIA,
                TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'DD/MM/YYYY') AS DATA_COMPLETA,
                RHAF1123.ORIGEM,
                TO_CHAR(TRUNC(RHAF1123.NUM_HORAS)) || ':' ||
                TO_CHAR(MOD(RHAF1123.NUM_HORAS * 60, 60), 'FM00') AS NUM_HORAS_HM,
                TRIM(TO_CHAR(SYSDATE, 'MONTH')) || '/' || TO_CHAR(SYSDATE, 'YYYY') AS REFERENCIA,
                TO_CHAR(SYSDATE, 'DD') || ' de ' || TRIM(TO_CHAR(SYSDATE, 'Month')) || ' de '
                || TO_CHAR(SYSDATE, 'YYYY') AS REF_COMPLETA,
                GER.NOME_PESSOA AS GERENTE
  FROM RHAF1123       RHAF1123,
       RHAF1129       RHAF1129,
       RHAF1138       RHAF1138,
       RHAF1108       RHAF1108,
       RHAF1119       RHAF1119,
       RHAF1145       RHAF1145,
       RHFP0310       RHFP0310,
       RHFP0400       RHFP0400,
       RHFP0401       RHFP0401,
       V_DADOS_PESSOA VDP,
       DADOS_GERENTES_LOJAS GER
 WHERE RHAF1123.COD_OCORRENCIA = RHAF1129.COD_OCORRENCIA
   AND RHAF1123.COD_CONTRATO = RHAF1108.COD_CONTRATO(+)
   AND RHAF1123.COD_CONTRATO = RHAF1119.COD_CONTRATO
   AND RHAF1119.COD_TURNO = RHAF1145.COD_TURNO
   AND RHAF1123.COD_CONTRATO = RHFP0310.COD_CONTRATO
   AND RHFP0310.COD_ORGANOGRAMA = RHFP0400.COD_ORGANOGRAMA
   AND RHFP0400.COD_ORGANOGRAMA = RHFP0401.COD_ORGANOGRAMA
   AND VDP.COD_CONTRATO = RHAF1123.COD_CONTRATO
   AND GER.EDICAO_ORG = VDP.COD_UNIDADE
   AND RHAF1123.DATA_OCORRENCIA BETWEEN :DATA_INICIO_OCO AND :DATA_FIM_OCO
   AND RHAF1123.DATA_OCORRENCIA BETWEEN RHAF1108.DATA_INICIO AND
       RHAF1108.DATA_FIM
   AND RHAF1129.COD_MOTIVO_OCO = RHAF1138.COD_MOTIVO_OCO(+)
   AND GER.COD_CONTRATO NOT IN 387620
   AND ROUND(RHAF1123.NUM_HORAS, 2) > 2
   AND RHFP0310.DATA_FIM = '31/12/2999'
   AND RHFP0401.COD_NIVEL2 = 8
   AND (RHFP0401.EDICAO_ORG = :FILIAL OR :FILIAL = 0)
   AND (VDP.COD_GRUPO = TO_CHAR(:REDE) OR TO_CHAR(:REDE) = 0)
   AND RHFP0401.EDICAO_NIVEL3 NOT IN ('013', '001')
   AND RHAF1123.COD_OCORRENCIA IN
       (203, 204, 207, 208, 209, 210, 211, 212, 213, 214, 2022, 2023, 2026, 2029, 2036, 2041, 2043)
 ORDER BY RHFP0401.EDICAO_ORG, RHAF1123.COD_CONTRATO ASC



--=======================--
--=======================--


--FORMULÁRIO DE IRREGULARIDADE INTERVALOS INFERIORES A 1H

SELECT DISTINCT RHAF1123.COD_CONTRATO,
                VDP.DES_PESSOA,
                RHFP0401.EDICAO_ORG,
                RHFP0400.NOME_ORGANOGRAMA,
                VDP.COD_GRUPO,
                VDP.DES_GRUPO,
                RHAF1129.COD_OCORRENCIA,
                RHAF1129.NOME_OCORRENCIA,
                TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MONTH') AS NOME_MES,
                TRIM(TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'Month')) || '/'
                || TO_CHAR(RHAF1123.DATA_OCORRENCIA,'YYYY') AS MES_OCORRENCIA,
                TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'DD/MM/YYYY') AS DATA_COMPLETA,
                RHAF1123.ORIGEM,
                TO_CHAR(TRUNC(RHAF1123.NUM_HORAS)) || ':' ||
                TO_CHAR(MOD(RHAF1123.NUM_HORAS * 60, 60), 'FM00') AS NUM_HORAS_HM,
                TRIM(TO_CHAR(SYSDATE, 'MONTH')) || '/' || TO_CHAR(SYSDATE, 'YYYY') AS REFERENCIA,
                TO_CHAR(SYSDATE, 'DD') || ' de ' || TRIM(TO_CHAR(SYSDATE, 'Month')) || ' de '
                || TO_CHAR(SYSDATE, 'YYYY') AS REF_COMPLETA,
                GER.NOME_PESSOA AS GERENTE
  FROM RHAF1123 RHAF1123,
       RHAF1129 RHAF1129,
       RHAF1138 RHAF1138,
       RHAF1108 RHAF1108,
       RHAF1119 RHAF1119,
       RHAF1145 RHAF1145,
       RHFP0310 RHFP0310,
       RHFP0400 RHFP0400,
       RHFP0401 RHFP0401,
       V_DADOS_PESSOA VDP,
       DADOS_GERENTES_LOJAS GER
 WHERE RHAF1123.COD_OCORRENCIA = RHAF1129.COD_OCORRENCIA
   AND RHAF1123.COD_CONTRATO = RHAF1108.COD_CONTRATO(+)
   AND RHAF1123.COD_CONTRATO = RHAF1119.COD_CONTRATO
   AND RHAF1119.COD_TURNO = RHAF1145.COD_TURNO
   AND RHAF1123.COD_CONTRATO = RHFP0310.COD_CONTRATO
   AND RHFP0310.COD_ORGANOGRAMA = RHFP0400.COD_ORGANOGRAMA
   AND RHFP0400.COD_ORGANOGRAMA = RHFP0401.COD_ORGANOGRAMA
   AND VDP.COD_CONTRATO = RHAF1123.COD_CONTRATO
   AND GER.EDICAO_ORG = VDP.COD_UNIDADE
   AND RHAF1123.DATA_OCORRENCIA BETWEEN :DATA_INICIO_OCO AND :DATA_FIM_OCO
   AND RHAF1123.DATA_OCORRENCIA BETWEEN RHAF1108.DATA_INICIO AND
       RHAF1108.DATA_FIM
   AND RHAF1129.COD_MOTIVO_OCO = RHAF1138.COD_MOTIVO_OCO(+)
   AND GER.COD_CONTRATO NOT IN 387620
   AND RHFP0310.DATA_FIM = '31/12/2999'
   AND RHFP0401.COD_NIVEL2 = 8
   AND (RHFP0401.EDICAO_ORG = :FILIAL OR :FILIAL = 0)
   AND (VDP.COD_GRUPO = TO_CHAR(:REDE) OR TO_CHAR(:REDE) = 0)
   AND RHFP0401.EDICAO_NIVEL3 NOT IN ('013', '001')
   AND RHAF1145.CARGA_HORARIA BETWEEN 195 AND 220
   AND RHAF1123.COD_OCORRENCIA = 2048
 ORDER BY RHFP0401.EDICAO_ORG, RHAF1123.COD_CONTRATO ASC


--=======================--
--=======================--


--FORMULÁRIO DE IRREGULARIDADE OCORRÊNCIAS INFORMADAS MANUALMENTE

 SELECT DISTINCT RHAF1123.COD_CONTRATO,
                VDP.DES_PESSOA,
                RHFP0401.EDICAO_ORG,
                RHFP0400.NOME_ORGANOGRAMA,
                VDP.COD_GRUPO,
                VDP.DES_GRUPO,
                RHAF1129.COD_OCORRENCIA,
                RHAF1129.NOME_OCORRENCIA,
                TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MONTH') AS NOME_MES,
                TRIM(TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'Month')) || '/'
                || TO_CHAR(RHAF1123.DATA_OCORRENCIA,'YYYY') AS MES_OCORRENCIA,
                TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'DD/MM/YYYY') AS DATA_COMPLETA,
                RHAF1123.ORIGEM,
                TO_CHAR(TRUNC(RHAF1123.NUM_HORAS)) || ':' ||
                TO_CHAR(MOD(RHAF1123.NUM_HORAS * 60, 60), 'FM00') AS NUM_HORAS_HM,
                TRIM(TO_CHAR(SYSDATE, 'MONTH')) || '/' || TO_CHAR(SYSDATE, 'YYYY') AS REFERENCIA,
                TO_CHAR(SYSDATE, 'DD') || ' de ' || TRIM(TO_CHAR(SYSDATE, 'Month')) || ' de '
                || TO_CHAR(SYSDATE, 'YYYY') AS REF_COMPLETA,
                GER.NOME_PESSOA AS GERENTE
  FROM RHAF1123 RHAF1123,
       RHAF1129 RHAF1129,
       RHAF1138 RHAF1138,
       RHAF1108 RHAF1108,
       RHAF1119 RHAF1119,
       RHAF1145 RHAF1145,
       RHFP0310 RHFP0310,
       RHFP0400 RHFP0400,
       RHFP0401 RHFP0401,
       V_DADOS_PESSOA VDP,
       DADOS_GERENTES_LOJAS GER
WHERE RHAF1123.COD_OCORRENCIA = RHAF1129.COD_OCORRENCIA
   AND RHAF1123.COD_CONTRATO = RHAF1108.COD_CONTRATO(+)
   AND RHAF1123.COD_CONTRATO = RHAF1119.COD_CONTRATO
   AND RHAF1119.COD_TURNO = RHAF1145.COD_TURNO
   AND RHAF1123.COD_CONTRATO = RHFP0310.COD_CONTRATO
   AND RHFP0310.COD_ORGANOGRAMA = RHFP0400.COD_ORGANOGRAMA
   AND RHFP0400.COD_ORGANOGRAMA = RHFP0401.COD_ORGANOGRAMA
   AND VDP.COD_CONTRATO = RHAF1123.COD_CONTRATO
   AND GER.EDICAO_ORG = VDP.COD_UNIDADE
   AND RHAF1123.DATA_OCORRENCIA BETWEEN :DATA_INICIO_OCO AND :DATA_FIM_OCO
   AND RHAF1123.DATA_OCORRENCIA BETWEEN RHAF1108.DATA_INICIO AND
       RHAF1108.DATA_FIM
   AND RHAF1129.COD_MOTIVO_OCO = RHAF1138.COD_MOTIVO_OCO(+)
   AND GER.COD_CONTRATO NOT IN 387620
   AND RHFP0310.DATA_FIM = '31/12/2999'
   AND RHFP0401.COD_NIVEL2 = 8
   AND (RHFP0401.EDICAO_ORG = :FILIAL OR :FILIAL = 0)
   AND (VDP.COD_GRUPO = TO_CHAR(:REDE) OR TO_CHAR(:REDE) = 0)
   AND RHFP0401.EDICAO_NIVEL3 NOT IN ('013', '001')
   AND RHAF1123.ORIGEM = 'I'
 ORDER BY RHFP0401.EDICAO_ORG, RHAF1123.COD_CONTRATO ASC



--=======================--
--=======================--


--FORMULÁRIO DE IRREGULARIDADE HORAS EXTRAS +10HRS


SELECT DISTINCT RHAF1123.COD_CONTRATO,
                VDP.DES_PESSOA,
                RHFP0401.EDICAO_ORG,
                RHFP0400.NOME_ORGANOGRAMA,
                VDP.COD_GRUPO,
                VDP.DES_GRUPO,
                RHAF1129.COD_OCORRENCIA,
                RHAF1129.NOME_OCORRENCIA,
                TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MONTH') AS NOME_MES,
                TRIM(TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'Month')) || '/'
                || TO_CHAR(RHAF1123.DATA_OCORRENCIA,'YYYY') AS MES_OCORRENCIA,
                TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'DD/MM/YYYY') AS DATA_COMPLETA,
                RHAF1123.ORIGEM,
                TO_CHAR(TRUNC(RHAF1123.NUM_HORAS)) || ':' ||
                TO_CHAR(MOD(RHAF1123.NUM_HORAS * 60, 60), 'FM00') AS NUM_HORAS_HM,
                TRIM(TO_CHAR(SYSDATE, 'MONTH')) || '/' || TO_CHAR(SYSDATE, 'YYYY') AS REFERENCIA,
                TO_CHAR(SYSDATE, 'DD') || ' de ' || TRIM(TO_CHAR(SYSDATE, 'Month')) || ' de '
                || TO_CHAR(SYSDATE, 'YYYY') AS REF_COMPLETA,
                GER.NOME_PESSOA AS GERENTE
  FROM RHAF1123 RHAF1123,
       RHAF1129 RHAF1129,
       RHAF1138 RHAF1138,
       RHAF1108 RHAF1108,
       RHAF1119 RHAF1119,
       RHAF1145 RHAF1145,
       RHFP0310 RHFP0310,
       RHFP0400 RHFP0400,
       RHFP0401 RHFP0401,
       V_DADOS_PESSOA VDP,
       DADOS_GERENTES_LOJAS GER
 WHERE RHAF1123.COD_OCORRENCIA = RHAF1129.COD_OCORRENCIA
   AND RHAF1123.COD_CONTRATO = RHAF1108.COD_CONTRATO(+)
   AND RHAF1123.COD_CONTRATO = RHAF1119.COD_CONTRATO
   AND RHAF1119.COD_TURNO = RHAF1145.COD_TURNO
   AND RHAF1123.COD_CONTRATO = RHFP0310.COD_CONTRATO
   AND RHFP0310.COD_ORGANOGRAMA = RHFP0400.COD_ORGANOGRAMA
   AND RHFP0400.COD_ORGANOGRAMA = RHFP0401.COD_ORGANOGRAMA
   AND VDP.COD_CONTRATO = RHAF1123.COD_CONTRATO
   AND GER.EDICAO_ORG = VDP.COD_UNIDADE
   AND RHAF1123.DATA_OCORRENCIA BETWEEN :DATA_INICIO_OCO AND :DATA_FIM_OCO
   AND RHAF1123.DATA_OCORRENCIA BETWEEN RHAF1108.DATA_INICIO AND
       RHAF1108.DATA_FIM
   AND RHAF1129.COD_MOTIVO_OCO = RHAF1138.COD_MOTIVO_OCO(+)
   AND GER.COD_CONTRATO NOT IN 387620
   AND RHFP0310.DATA_FIM = '31/12/2999'
   AND RHFP0401.COD_NIVEL2 = 8
   AND (RHFP0401.EDICAO_ORG = :FILIAL OR :FILIAL = 0)
   AND (VDP.COD_GRUPO = TO_CHAR(:REDE) OR TO_CHAR(:REDE) = 0)
   AND RHFP0401.EDICAO_NIVEL3 NOT IN ('013', '001')
   AND RHAF1123.COD_OCORRENCIA = 2
   AND RHAF1123.NUM_HORAS > 10
 ORDER BY RHFP0401.EDICAO_ORG, RHAF1123.COD_CONTRATO ASC



--=======================--
--=======================--


--FORMULÁRIO DE IRREGULARIDADE INTERVALOS INFERIORES A 15MIN


SELECT DISTINCT RHAF1123.COD_CONTRATO,
                VDP.DES_PESSOA,
                RHFP0401.EDICAO_ORG,
                RHFP0400.NOME_ORGANOGRAMA,
                VDP.COD_GRUPO,
                VDP.DES_GRUPO,
                RHAF1129.COD_OCORRENCIA,
                RHAF1129.NOME_OCORRENCIA,
                TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MONTH') AS NOME_MES,
                TRIM(TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'Month')) || '/'
                || TO_CHAR(RHAF1123.DATA_OCORRENCIA,'YYYY') AS MES_OCORRENCIA,
                TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'DD/MM/YYYY') AS DATA_COMPLETA,
                RHAF1123.ORIGEM,
                TO_CHAR(TRUNC(RHAF1123.NUM_HORAS)) || ':' ||
                TO_CHAR(MOD(RHAF1123.NUM_HORAS * 60, 60), 'FM00') AS NUM_HORAS_HM,
                TRIM(TO_CHAR(SYSDATE, 'MONTH')) || '/' || TO_CHAR(SYSDATE, 'YYYY') AS REFERENCIA,
                TO_CHAR(SYSDATE, 'DD') || ' de ' || TRIM(TO_CHAR(SYSDATE, 'Month')) || ' de '
                || TO_CHAR(SYSDATE, 'YYYY') AS REF_COMPLETA,
                GER.NOME_PESSOA AS GERENTE
  FROM RHAF1123 RHAF1123,
       RHAF1129 RHAF1129,
       RHAF1138 RHAF1138,
       RHAF1108 RHAF1108,
       RHAF1119 RHAF1119,
       RHAF1145 RHAF1145,
       RHFP0310 RHFP0310,
       RHFP0400 RHFP0400,
       RHFP0401 RHFP0401,
       V_DADOS_PESSOA VDP,
       DADOS_GERENTES_LOJAS GER
 WHERE RHAF1123.COD_OCORRENCIA = RHAF1129.COD_OCORRENCIA
   AND RHAF1123.COD_CONTRATO = RHAF1108.COD_CONTRATO(+)
   AND RHAF1123.COD_CONTRATO = RHAF1119.COD_CONTRATO
   AND RHAF1119.COD_TURNO = RHAF1145.COD_TURNO
   AND RHAF1123.COD_CONTRATO = RHFP0310.COD_CONTRATO
   AND RHFP0310.COD_ORGANOGRAMA = RHFP0400.COD_ORGANOGRAMA
   AND RHFP0400.COD_ORGANOGRAMA = RHFP0401.COD_ORGANOGRAMA
   AND VDP.COD_CONTRATO = RHAF1123.COD_CONTRATO
   AND GER.EDICAO_ORG = VDP.COD_UNIDADE
   AND RHAF1123.DATA_OCORRENCIA BETWEEN :DATA_INICIO_OCO AND :DATA_FIM_OCO
   AND RHAF1123.DATA_OCORRENCIA BETWEEN RHAF1108.DATA_INICIO AND
       RHAF1108.DATA_FIM
   AND RHAF1129.COD_MOTIVO_OCO = RHAF1138.COD_MOTIVO_OCO(+)
   AND GER.COD_CONTRATO NOT IN 387620
   AND RHFP0310.DATA_FIM = '31/12/2999'
   AND RHFP0401.COD_NIVEL2 = 8
   AND (RHFP0401.EDICAO_ORG = :FILIAL OR :FILIAL = 0)
   AND (VDP.COD_GRUPO = TO_CHAR(:REDE) OR TO_CHAR(:REDE) = 0)
   AND RHFP0401.EDICAO_NIVEL3 NOT IN ('013', '001')
   AND RHAF1145.CARGA_HORARIA BETWEEN 165 AND 180
   AND RHAF1123.COD_OCORRENCIA = 2049
 ORDER BY RHFP0401.EDICAO_ORG, RHAF1123.COD_CONTRATO ASC



--=======================--
--=======================--


--FORMULÁRIO DE IRREGULARIDADE INTRAJORNADA INFERIOR A 11HRS


SELECT DISTINCT RHAF1123.COD_CONTRATO,
                VDP.DES_PESSOA,
                RHFP0401.EDICAO_ORG,
                RHFP0400.NOME_ORGANOGRAMA,
                VDP.COD_GRUPO,
                VDP.DES_GRUPO,
                RHAF1129.COD_OCORRENCIA,
                RHAF1129.NOME_OCORRENCIA,
                TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MONTH') AS NOME_MES,
                TRIM(TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'Month')) || '/'
                || TO_CHAR(RHAF1123.DATA_OCORRENCIA,'YYYY') AS MES_OCORRENCIA,
                TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'DD/MM/YYYY') AS DATA_COMPLETA,
                RHAF1123.ORIGEM,
                TO_CHAR(TRUNC(RHAF1123.NUM_HORAS)) || ':' ||
                TO_CHAR(MOD(RHAF1123.NUM_HORAS * 60, 60), 'FM00') AS NUM_HORAS_HM,
                TRIM(TO_CHAR(SYSDATE, 'MONTH')) || '/' || TO_CHAR(SYSDATE, 'YYYY') AS REFERENCIA,
                TO_CHAR(SYSDATE, 'DD') || ' de ' || TRIM(TO_CHAR(SYSDATE, 'Month')) || ' de '
                || TO_CHAR(SYSDATE, 'YYYY') AS REF_COMPLETA,
                GER.NOME_PESSOA AS GERENTE
  FROM RHAF1123 RHAF1123,
       RHAF1129 RHAF1129,
       RHAF1138 RHAF1138,
       RHAF1108 RHAF1108,
       RHAF1119 RHAF1119,
       RHAF1145 RHAF1145,
       RHFP0310 RHFP0310,
       RHFP0400 RHFP0400,
       RHFP0401 RHFP0401,
       V_DADOS_PESSOA VDP,
       DADOS_GERENTES_LOJAS GER
 WHERE RHAF1123.COD_OCORRENCIA = RHAF1129.COD_OCORRENCIA
   AND RHAF1123.COD_CONTRATO = RHAF1108.COD_CONTRATO(+)
   AND RHAF1123.COD_CONTRATO = RHAF1119.COD_CONTRATO
   AND RHAF1119.COD_TURNO = RHAF1145.COD_TURNO
   AND RHAF1123.COD_CONTRATO = RHFP0310.COD_CONTRATO
   AND RHFP0310.COD_ORGANOGRAMA = RHFP0400.COD_ORGANOGRAMA
   AND RHFP0400.COD_ORGANOGRAMA = RHFP0401.COD_ORGANOGRAMA
   AND VDP.COD_CONTRATO = RHAF1123.COD_CONTRATO
   AND GER.EDICAO_ORG = VDP.COD_UNIDADE
   AND RHAF1123.DATA_OCORRENCIA BETWEEN :DATA_INICIO_OCO AND :DATA_FIM_OCO
   AND RHAF1123.DATA_OCORRENCIA BETWEEN RHAF1108.DATA_INICIO AND
       RHAF1108.DATA_FIM
   AND RHAF1129.COD_MOTIVO_OCO = RHAF1138.COD_MOTIVO_OCO(+)
   AND GER.COD_CONTRATO NOT IN 387620
   AND RHFP0310.DATA_FIM = '31/12/2999'
   AND RHFP0401.COD_NIVEL2 = 8
   AND (RHFP0401.EDICAO_ORG = :FILIAL OR :FILIAL = 0)
   AND (VDP.COD_GRUPO = TO_CHAR(:REDE) OR TO_CHAR(:REDE) = 0)
   AND RHFP0401.EDICAO_NIVEL3 NOT IN ('013', '001')
   AND RHAF1123.COD_OCORRENCIA = 901
 ORDER BY RHFP0401.EDICAO_ORG, RHAF1123.COD_CONTRATO ASC





