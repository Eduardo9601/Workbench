--to_date
('15/'||to_char(add_months(TRUNC(SYSDATE),-1),'mm/yyyy'),'dd/mm/yyyy')

--to_date
('15/'||to_char(TRUNC(SYSDATE),'mm/yyyy')) -- PERÍODO ENTRE DIA 15 DO 



SELECT PESSOA.EDICAO_NIVEL3,
       PESSOA.NOME_ORGANOGRAMA,
       CARGO.COD_CLH,
       CARGO.NOME_CLH,
       PESSOA.COD_CONTRATO,
       PESSOA.NOME_FUNCIONARIO,
       (TRIM(TO_CHAR(RHYF0118(TEMPO.TEMPO_LOGIN_EM_HORAS), '990,00'))) AS TEMPO_LOGIN_TOT,
       PESSOA.DATA_DEMISSAO,
       K.QTD_HORBAS_MES
  FROM (SELECT F.COD_USUARIO,
               SUM(ROUND((F.TEMPO_LOGIN / 60), 2)) AS TEMPO_LOGIN_EM_HORAS
          FROM SISLOGWEB.GER_TEMPO_LOGIN@NLGRZ F
         WHERE TO_DATE(SUBSTR(HORA_INICIAL, 1, 10)) >= :DATA_INICIO
           AND TO_DATE(SUBSTR(HORA_INICIAL, 1, 10)) <= :DATA_FIM
         GROUP BY F.COD_USUARIO) TEMPO,
       (SELECT DISTINCT G.EDICAO_NIVEL3,
                        E.NOME_ORGANOGRAMA,
                        B.COD_CONTRATO,
                        A.NOME_PESSOA AS NOME_FUNCIONARIO,
                        H.COD_CLH,
                        B.DATA_FIM AS DATA_DEMISSAO
          FROM PESSOA   A,
               RHFP0300 B,
               RHFP0310 D,
               RHFP0400 E,
               RHFP0401 G,
               RHFP0340 H,
               RHFP0500 J
         WHERE B.COD_FUNC = A.COD_PESSOA
           AND D.COD_CONTRATO = B.COD_CONTRATO
           AND B.COD_CONTRATO = H.COD_CONTRATO
           AND H.COD_CLH = J.COD_CLH
           AND D.DATA_FIM = '31/12/2999'
           AND H.DATA_FIM = '31/12/2999'
           AND E.COD_ORGANOGRAMA = D.COD_ORGANOGRAMA
           AND E.COD_ORGANOGRAMA = G.COD_ORGANOGRAMA
           AND G.EDICAO_ORG = :FILIAL
           AND G.EDICAO_NIVEL3 NOT IN ('001', '013')
         ORDER BY G.EDICAO_NIVEL3, B.COD_CONTRATO) PESSOA,
       (SELECT A.COD_CONTRATO, A.COD_CLH, B.NOME_CLH
          FROM RHFP0340 A, RHFP0500 B
         WHERE A.COD_CLH = B.COD_CLH
           AND A.DATA_FIM = '31/12/2999'
           AND A.COD_CLH NOT IN
               (6, 7, 8, 14, 77, 78, 79, 80, 81, 86, 87, 88, 89, 90, 92, 93, 71, 74, 75, 68, 199, 202, 209, 213, 216, 221, 310, 128, 132, 133, 134, 135, 137, 148, 184, 185, 186, 188, 189, 190, 191, 192, 195, 196, 102, 197, 247, 252, 255, 264, 268, 275, 278, 279, 283, 294, 299, 301, 302, 304, 318, 325)) CARGO,
       RHFP0307 G,
       RHFP0321 K
 WHERE TEMPO.COD_USUARIO = PESSOA.COD_CONTRATO
   AND CARGO.COD_CONTRATO = PESSOA.COD_CONTRATO
   AND PESSOA.COD_CLH = CARGO.COD_CLH
   AND G.COD_CONTRATO = TEMPO.COD_USUARIO
   AND K.COD_HORAS_BASE = G.COD_HORAS_BASE
   AND G.DATA_FIM = '31/12/2999'
   AND PESSOA.EDICAO_NIVEL3 NOT IN
       ('285', '269', '266', '190', '607', '224', '158', '290', '287', '254',
        '277', '421', '413', '252', '278', '526', '228', '283', '202', '198',
        '291')
-- AND PESSOA.COD_CONTRATO = 388239
 ORDER BY PESSOA.EDICAO_NIVEL3, TEMPO.COD_USUARIO