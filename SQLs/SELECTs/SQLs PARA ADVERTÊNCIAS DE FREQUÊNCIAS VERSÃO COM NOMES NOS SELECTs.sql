--CONSULTAS SQLs MODIFICADAS COM NOMES PARA FACILITAR A CONSULTA

--SQL HORAS EXTRAS COM MARCAÇÃO COM MAIS DE 2H DIÁRIAS

WITH HORAS_EXTRAS AS (
  SELECT DISTINCT RHAF1123.COD_CONTRATO,
                  RHFP0401.EDICAO_ORG,
                  RHFP0400.NOME_ORGANOGRAMA,
                  RHAF1123.DATA_OCORRENCIA,
                  TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MONTH') AS MES_OCORRENCIA,
                  RHAF1123.COD_OCORRENCIA,
                  RHAF1129.NOME_OCORRENCIA,
                  RHAF1123.ORIGEM,
                  RHAF1123.NUM_HORAS,
                  (TRIM(TO_CHAR(RHYF0118(RHAF1123.NUM_HORAS), '990,00'))) AS NUM_HORAS_HM
    FROM RHAF1123 RHAF1123,
         RHAF1129 RHAF1129,
         RHAF1138 RHAF1138,
         RHAF1108 RHAF1108,
         RHFP0310 RHFP0310,
         RHFP0400 RHFP0400,
         RHFP0401 RHFP0401
   WHERE RHAF1123.COD_OCORRENCIA = RHAF1129.COD_OCORRENCIA
     AND RHAF1123.COD_CONTRATO = RHAF1108.COD_CONTRATO(+)
     AND RHAF1123.COD_CONTRATO = RHFP0310.COD_CONTRATO
     AND RHFP0310.COD_ORGANOGRAMA = RHFP0400.COD_ORGANOGRAMA
     AND RHFP0400.COD_ORGANOGRAMA = RHFP0401.COD_ORGANOGRAMA
     AND RHAF1123.DATA_OCORRENCIA BETWEEN '01/05/2023' AND '31/05/2023'
     AND RHAF1123.DATA_OCORRENCIA BETWEEN RHAF1108.DATA_INICIO AND RHAF1108.DATA_FIM
     AND RHAF1129.COD_MOTIVO_OCO = RHAF1138.COD_MOTIVO_OCO(+)
     AND RHAF1123.NUM_HORAS > 2
     AND RHFP0310.DATA_FIM = '31/12/2999'
     AND RHAF1123.COD_OCORRENCIA IN
         (203, 204, 207, 208, 209, 210, 211, 212, 213, 214, 2022, 2023, 2026, 2029, 2036, 2041, 2043)
)
SELECT * FROM HORAS_EXTRAS
ORDER BY COD_CONTRATO ASC;




--========================================--
--========================================--


