--SQL DE QUANTIDADE DE RAÇA/COR COLABORADORES COM CARGOS DE LIDERANÇA


SELECT
    A.COD_RACA_COR,
    B.NOME_RACA_COR,
    'LIDERANÇA' AS CARGO,
    COUNT(A.COD_RACA_COR) AS QTDE
FROM  RHFP0200 A
    , RHFP0130 B
    , RHFP0300 C
    , RHFP0340 D
    , RHFP0500 E
WHERE
    A.COD_RACA_COR = B.COD_RACA_COR
    AND A.COD_FUNC = C.COD_FUNC
    AND D.COD_CONTRATO = C.COD_CONTRATO
    AND E.COD_CLH = D.COD_CLH
    AND D.DATA_FIM = '31/12/2999'
    AND (C.DATA_FIM IS NULL OR C.DATA_FIM > TRUNC(SYSDATE)) -- SOMENTEATIVOS
    --AND B.COD_RACA_COR IN (1, 9)
    AND E.COD_CLH IN (1, 2, 3, 4, 5, 7, 8, 12, 13, 14, 16, 26, 27, 77,
                     78, 79, 80, 81, 86, 87, 88, 90, 128, 137, 153,
                     184, 185, 186, 188, 189, 190, 192, 244, 255, 264,
                     266, 274, 275, 277, 280, 283, 292, 294, 299, 312,
                     316, 318, 321, 323, 325, 330, 335, 341, 344, 345, 355)
GROUP BY
    A.COD_RACA_COR,
    B.NOME_RACA_COR
ORDER BY
    COUNT(A.COD_RACA_COR) DESC


--VERSÃO 2 FUNCIONAL

SELECT
    'LIDERANÇA' AS CARGO,
    SUM(CASE WHEN A.COD_RACA_COR = 1 THEN 1 ELSE 0 END) AS QTDE_INDIGENA,
    SUM(CASE WHEN A.COD_RACA_COR = 2 THEN 1 ELSE 0 END) AS QTDE_BRANCA,
    SUM(CASE WHEN A.COD_RACA_COR = 4 THEN 1 ELSE 0 END) AS QTDE_PRETA,
    SUM(CASE WHEN A.COD_RACA_COR = 6 THEN 1 ELSE 0 END) AS QTDE_AMARELA,
    SUM(CASE WHEN A.COD_RACA_COR = 8 THEN 1 ELSE 0 END) AS QTDE_PARDA,
    SUM(CASE WHEN A.COD_RACA_COR = 9 THEN 1 ELSE 0 END) AS QTDE_NAO_INFORMADO,
    COUNT(A.COD_RACA_COR) AS TOTAL
FROM  RHFP0200 A
    , RHFP0130 B
    , RHFP0300 C
    , RHFP0340 D
    , RHFP0500 E
WHERE
    A.COD_RACA_COR = B.COD_RACA_COR
    AND A.COD_FUNC = C.COD_FUNC
    AND D.COD_CONTRATO = C.COD_CONTRATO
    AND E.COD_CLH = D.COD_CLH
    AND D.DATA_FIM = '31/12/2999'
    AND (C.DATA_FIM IS NULL OR C.DATA_FIM > TRUNC(SYSDATE)) -- SOMENTEATIVOS
    AND E.COD_CLH IN (1, 2, 3, 4, 5, 7, 8, 12, 13, 14, 16, 26, 27, 77,
                     78, 79, 80, 81, 86, 87, 88, 90, 128, 137, 153,
                     184, 185, 186, 188, 189, 190, 192, 244, 255, 264,
                     266, 274, 275, 277, 280, 283, 292, 294, 299, 312,
                     316, 318, 321, 323, 325, 330, 335, 341, 344, 345, 355)

    





--SQL DE QUANTIDADE DE RAÇA/COR COLABORADORES SEM CARGOS DE LIDERANÇA



SELECT
    A.COD_RACA_COR,
    B.NOME_RACA_COR,
    'NÃO-LIDERANÇA' AS CARGO,
    COUNT(A.COD_RACA_COR) AS QTDE
FROM  RHFP0200 A
    , RHFP0130 B
    , RHFP0300 C
    , RHFP0340 D
    , RHFP0500 E
WHERE
    A.COD_RACA_COR = B.COD_RACA_COR
    AND A.COD_FUNC = C.COD_FUNC
    AND D.COD_CONTRATO = C.COD_CONTRATO
    AND E.COD_CLH = D.COD_CLH
    AND D.DATA_FIM = '31/12/2999'
    AND (C.DATA_FIM IS NULL OR C.DATA_FIM > TRUNC(SYSDATE)) -- SOMENTEATIVOS
    --AND B.COD_RACA_COR IN (1, 9)
    AND E.COD_CLH NOT IN (1, 2, 3, 4, 5, 7, 8, 12, 13, 14, 16, 26, 27, 77,
                     78, 79, 80, 81, 86, 87, 88, 90, 128, 137, 153,
                     184, 185, 186, 188, 189, 190, 192, 244, 255, 264,
                     266, 274, 275, 277, 280, 283, 292, 294, 299, 312,
                     316, 318, 321, 323, 325, 330, 335, 341, 344, 345, 355)
GROUP BY
    A.COD_RACA_COR,
    B.NOME_RACA_COR
ORDER BY
    COUNT(A.COD_RACA_COR) DESC