/*PROCESSO PARA RETIFICAR EM FOLHA, CÁLCULOS DE APRENDIZES QUE FORAM CADASTRADOS COM CÓDIGO DE E-SOCIAL(VÍNCULO EMPREGATÍCIO DO E-SOCIAL) INCORRETO*/

--PASSO 0 - BACKUP DE TODOS OS CÁLCULOS DOS CONTRATOS

SELECT * FROM RHFP1006
WHERE COD_CONTRATO IN (395852)
AND COD_MESTRE_EVENTO = 17090

--396378

-->PRECEDENTE É REALIZAR O CÁLCULO INDIVIDUAL.

--PASSO 1

SELECT * FROM RHFP1006
WHERE COD_CONTRATO IN (395852, 396378)
AND COD_MESTRE_EVENTO = 17712

DELETE FROM RHFP1006
WHERE COD_CONTRATO IN (395852, 396378)
AND COD_MESTRE_EVENTO = 17712


--PASSO 2

INSERT INTO RHFP1006 (COD_MESTRE_EVENTO, COD_CONTRATO, COD_VD, TIPO_INF_VD, PRESTACAO_VD, QTDE_VD, VALOR_VD, COD_ORIGEM_MOV)
SELECT  COD_MESTRE_EVENTO, COD_CONTRATO,COD_VD, TIPO_INF_VD, PRESTACAO_VD, QTDE_VD, VALOR_VD, '3' AS COD_ORIGEM_MOV
FROM RHFP1005
WHERE COD_CONTRATO IN (395852, 396378)
AND COD_MESTRE_EVENTO = 17712


--PASSO 3

SELECT A.*, ROWID FROM RHFP1003 A
WHERE A.COD_MESTRE_EVENTO = 17712

UPDATE RHFP1003
SET SITUACAO_PROCESSO = 'I' AND DATA_PROCESSO
WHERE COD_MESTRE_EVENTO = 17151

