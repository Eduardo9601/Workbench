SET TERMOUT ON HEADING ON FEEDBACK ON VERIFY ON LINESIZE 1000
accept FILE prompt "ARQUIVO: "
accept PASSWORD_SYS prompt "SENHA DO USUARIO SYSTEM: " HIDE
accept OWNER prompt "NOME DO USUARIO PROPRIETARIO DA TABELA : "
accept PASSWORD_ORIG prompt "SENHA DO USUARIO PROPRIETARIO DA TABELA: " HIDE
accept OPERADOR prompt "NOME DO OPERADOR : "
accept HOST_STRING prompt "HOST_STRING: "
SET TERMOUT OFF HEADING OFF FEEDBACK OFF VERIFY OFF

CONNECT SYSTEM/&&PASSWORD_SYS@&&HOST_STRING;
GRANT CREATE ANY SYNONYM TO &&OWNER WITH ADMIN OPTION;

CONNECT &&OWNER/&&PASSWORD_ORIG@&&HOST_STRING;

SPOOL &&FILE

SELECT 'PROMPT CONECTANDO ...' || CHR(10) || 'CONNECT &&OWNER'||'/'||'&&PASSWORD_ORIG'||'@'||'&&HOST_STRING'
FROM DUAL;
SELECT 'PROMPT CRIANDO SINONIMOS...'
FROM DUAL;

SELECT 'CREATE SYNONYM "' || DS.OWNER || '".' || AO.OBJECT_NAME ||' FOR &&OWNER'||'.'|| AO.OBJECT_NAME ||';' 
FROM USER_OBJECTS AO,  
     (SELECT COD_OPERADOR AS OWNER
      FROM OPERADOR
      WHERE COD_OPERADOR = '&&OPERADOR') DS 
WHERE AO.OBJECT_TYPE NOT IN ('TRIGGER', 'PACKAGE BODY','INDEX','LIBRARY','TYPE','TYPE BODY');
  
SELECT 'PROMPT CONCEDENDO PRIVILEGIOS ...'
FROM DUAL;

SELECT 'GRANT ALL ON &&OWNER' || '.' ||AO.OBJECT_NAME||' TO "'|| DS.OWNER ||'" WITH GRANT OPTION;' 
FROM USER_OBJECTS AO,
     (SELECT COD_OPERADOR AS OWNER
      FROM OPERADOR 
      WHERE COD_OPERADOR = '&&OPERADOR') DS 
WHERE AO.OBJECT_TYPE NOT IN ('PACKAGE BODY','INDEX','LIBRARY','TYPE','TYPE BODY');
SPOOL OFF

SET TERMOUT ON HEADING ON FEEDBACK ON VERIFY ON
@&&FILE
