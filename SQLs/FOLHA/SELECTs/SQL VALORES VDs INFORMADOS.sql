SELECT
  CASE
    WHEN GROUPING(COD_VD) = 1 THEN 'Total'
    ELSE TO_CHAR(COD_VD)
  END AS COD_VD,
  TO_CHAR(SUM(VALOR_VD), '9G999G999G990D00') AS TOTAL_VALOR
FROM RHFP1006
WHERE COD_MESTRE_EVENTO =15922
AND COD_VD IN (907,948,949)
GROUP BY ROLLUP(COD_VD)




SELECT
  CASE
    WHEN GROUPING(COD_VD) = 1 THEN 'Total'
    ELSE TO_CHAR(COD_VD)
  END AS COD_VD,
  TO_CHAR(SUM(VALOR_VD), '9G999G999G990D00') AS TOTAL_VALOR
FROM RHFP1004
WHERE COD_EVENTO =21
AND DATA_MOV = '31/05/2023'
AND COD_VD IN (2211,2221,2231)
GROUP BY ROLLUP(COD_VD)