--SQL HORAS EXTRAS COM MARCAÇÃO COM MAIS DE 2H DIÁRIAS
 
SELECT DISTINCT RHAF1123.COD_CONTRATO,
                RHFP0401.EDICAO_ORG,
                RHFP0400.NOME_ORGANOGRAMA,
                RHAF1123.DATA_OCORRENCIA,
                TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MM/YYYY') AS MES_OCORRENCIA,
                RHAF1123.COD_OCORRENCIA,
                RHAF1129.NOME_OCORRENCIA,
                RHAF1123.ORIGEM,
                ROUND(RHAF1123.NUM_HORAS, 2) AS NUM_HORAS,
                (TRIM(TO_CHAR(RHYF0118(ROUND(RHAF1123.NUM_HORAS, 2)),
                              '990,00'))) AS NUM_HORAS_HM
  FROM RHAF1123 RHAF1123,
       RHAF1129 RHAF1129,
       RHAF1138 RHAF1138,
       RHAF1108 RHAF1108,
       RHFP0310 RHFP0310,
       RHFP0400 RHFP0400,
       RHFP0401 RHFP0401
 WHERE RHAF1123.COD_OCORRENCIA = RHAF1129.COD_OCORRENCIA
   AND RHAF1123.COD_CONTRATO = RHAF1108.COD_CONTRATO(+)
   AND RHAF1123.COD_CONTRATO = RHFP0310.COD_CONTRATO
   AND RHFP0310.COD_ORGANOGRAMA = RHFP0400.COD_ORGANOGRAMA
   AND RHFP0400.COD_ORGANOGRAMA = RHFP0401.COD_ORGANOGRAMA
   AND RHAF1123.DATA_OCORRENCIA BETWEEN '01/05/2023' AND '31/05/2023'
   AND RHAF1123.DATA_OCORRENCIA BETWEEN RHAF1108.DATA_INICIO AND
       RHAF1108.DATA_FIM
   AND RHAF1129.COD_MOTIVO_OCO = RHAF1138.COD_MOTIVO_OCO(+)
   AND ROUND(RHAF1123.NUM_HORAS, 2) > 2
   AND RHFP0310.DATA_FIM = '31/12/2999'
   AND RHAF1123.COD_OCORRENCIA IN
       (203, 204, 207, 208, 209, 210, 211, 212, 213, 214, 2022, 2023, 2026, 2029, 2036, 2041, 2043)
 ORDER BY RHFP0401.EDICAO_ORG ASC;


--VERSÃO TOTALIZADORA POR FILIAL

SELECT RHFP0401.EDICAO_ORG,
       RHFP0400.NOME_ORGANOGRAMA,
       TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MM/YYYY') AS MES_OCORRENCIA,
       RHAF1123.ORIGEM,
       TO_CHAR(SUM(TRUNC(RHAF1123.NUM_HORAS)) +
               TRUNC(SUM((RHAF1123.NUM_HORAS - TRUNC(RHAF1123.NUM_HORAS)) * 60) / 60),
               'FM9900') || ':' ||
       TO_CHAR(MOD(SUM((RHAF1123.NUM_HORAS - TRUNC(RHAF1123.NUM_HORAS)) * 60),
                   60),
               'FM00') AS TOTAL_HORAS_HM
  FROM RHAF1123 RHAF1123
  JOIN RHAF1129 RHAF1129 ON RHAF1123.COD_OCORRENCIA =
                            RHAF1129.COD_OCORRENCIA
  LEFT JOIN RHAF1108 RHAF1108 ON RHAF1123.COD_CONTRATO =
                                 RHAF1108.COD_CONTRATO
  JOIN RHFP0310 RHFP0310 ON RHAF1123.COD_CONTRATO = RHFP0310.COD_CONTRATO
  JOIN RHFP0400 RHFP0400 ON RHFP0310.COD_ORGANOGRAMA =
                            RHFP0400.COD_ORGANOGRAMA
  JOIN RHFP0401 RHFP0401 ON RHFP0400.COD_ORGANOGRAMA =
                            RHFP0401.COD_ORGANOGRAMA
  LEFT JOIN RHAF1138 RHAF1138 ON RHAF1129.COD_MOTIVO_OCO =
                                 RHAF1138.COD_MOTIVO_OCO
 WHERE RHAF1123.DATA_OCORRENCIA BETWEEN '01/05/2023' AND '31/05/2023'
   AND RHAF1123.DATA_OCORRENCIA BETWEEN RHAF1108.DATA_INICIO AND
       RHAF1108.DATA_FIM
   AND ROUND(RHAF1123.NUM_HORAS, 2) > 2
   AND RHFP0310.DATA_FIM = '31/12/2999'
   AND RHFP0401.COD_NIVEL2 = 8
   AND RHFP0401.EDICAO_NIVEL3 NOT IN ('013', '001')
   AND RHAF1123.COD_OCORRENCIA IN
       (203, 204, 207, 208, 209, 210, 211, 212, 213, 214, 2022, 2023, 2026, 2029, 2036, 2041, 2043)
 GROUP BY RHFP0401.EDICAO_ORG,
          RHFP0400.NOME_ORGANOGRAMA,
          TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MM/YYYY'),
          RHAF1123.ORIGEM
 ORDER BY RHFP0401.EDICAO_ORG ASC;


--===================--
--===================--





--SQL INTERVALOS DE JORNADAS INFERIOR A 1H (195 A 220)

SELECT DISTINCT RHAF1123.COD_CONTRATO,
                RHFP0401.EDICAO_ORG,
                RHFP0400.NOME_ORGANOGRAMA,
                RHAF1123.DATA_OCORRENCIA,
                TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MM/YYYY') AS MES_OCORRENCIA,
                RHAF1123.COD_OCORRENCIA,
                RHAF1129.NOME_OCORRENCIA,
                RHAF1123.ORIGEM,
                RHAF1123.NUM_HORAS,
                (TRIM(TO_CHAR(RHYF0118(RHAF1123.NUM_HORAS), '990,00'))) AS NUM_HORAS_HM
  FROM RHAF1123 RHAF1123,
       RHAF1129 RHAF1129,
       RHAF1138 RHAF1138,
       RHAF1108 RHAF1108,
       RHAF1119 RHAF1119,
       RHAF1145 RHAF1145,
       RHFP0310 RHFP0310,
       RHFP0400 RHFP0400,
       RHFP0401 RHFP0401
 WHERE RHAF1123.COD_OCORRENCIA = RHAF1129.COD_OCORRENCIA
   AND RHAF1123.COD_CONTRATO = RHAF1108.COD_CONTRATO(+)
   AND RHAF1123.COD_CONTRATO = RHAF1119.COD_CONTRATO
   AND RHAF1119.COD_TURNO = RHAF1145.COD_TURNO
   AND RHAF1123.COD_CONTRATO = RHFP0310.COD_CONTRATO
   AND RHFP0310.COD_ORGANOGRAMA = RHFP0400.COD_ORGANOGRAMA
   AND RHFP0400.COD_ORGANOGRAMA = RHFP0401.COD_ORGANOGRAMA
   AND RHAF1123.DATA_OCORRENCIA BETWEEN '01/05/2023' AND '31/05/2023'
   AND RHAF1123.DATA_OCORRENCIA BETWEEN RHAF1108.DATA_INICIO AND
       RHAF1108.DATA_FIM
   AND RHAF1129.COD_MOTIVO_OCO = RHAF1138.COD_MOTIVO_OCO(+)
   AND RHFP0310.DATA_FIM = '31/12/2999'
   AND RHAF1145.CARGA_HORARIA BETWEEN 195 AND 220
   AND RHAF1123.COD_OCORRENCIA = 2048
 ORDER BY RHAF1123.COD_CONTRATO ASC;



--VERSÃO TOTALIZADORA POR FILIAL

SELECT RHFP0401.EDICAO_ORG,
       RHFP0400.NOME_ORGANOGRAMA,
       TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MM/YYYY') AS MES_OCORRENCIA,
       RHAF1123.ORIGEM,
       TO_CHAR(SUM(TRUNC(RHAF1123.NUM_HORAS)) +
               TRUNC(SUM((RHAF1123.NUM_HORAS - TRUNC(RHAF1123.NUM_HORAS)) * 60) / 60),
               'FM9900') || ':' ||
       TO_CHAR(MOD(SUM((RHAF1123.NUM_HORAS - TRUNC(RHAF1123.NUM_HORAS)) * 60),
                   60),
               'FM00') AS TOTAL_HORAS_HM
  FROM RHAF1123 RHAF1123
  JOIN RHAF1129 RHAF1129 ON RHAF1123.COD_OCORRENCIA =
                            RHAF1129.COD_OCORRENCIA
  LEFT JOIN RHAF1108 RHAF1108 ON RHAF1123.COD_CONTRATO =
                                 RHAF1108.COD_CONTRATO
  JOIN RHAF1119 ON RHAF1123.COD_CONTRATO = RHAF1119.COD_CONTRATO
  JOIN RHAF1145 ON RHAF1119.COD_TURNO = RHAF1145.COD_TURNO
  JOIN RHFP0310 RHFP0310 ON RHAF1123.COD_CONTRATO = RHFP0310.COD_CONTRATO
  JOIN RHFP0400 RHFP0400 ON RHFP0310.COD_ORGANOGRAMA =
                            RHFP0400.COD_ORGANOGRAMA
  JOIN RHFP0401 RHFP0401 ON RHFP0400.COD_ORGANOGRAMA =
                            RHFP0401.COD_ORGANOGRAMA
  LEFT JOIN RHAF1138 RHAF1138 ON RHAF1129.COD_MOTIVO_OCO =
                                 RHAF1138.COD_MOTIVO_OCO
 WHERE RHAF1123.DATA_OCORRENCIA BETWEEN '01/05/2023' AND '31/05/2023'
   AND RHAF1123.DATA_OCORRENCIA BETWEEN RHAF1108.DATA_INICIO AND
       RHAF1108.DATA_FIM
   AND RHFP0310.DATA_FIM = '31/12/2999'
   AND RHAF1145.CARGA_HORARIA BETWEEN 195 AND 220
   AND RHAF1123.COD_OCORRENCIA = 2048
   AND RHFP0401.COD_NIVEL2 = 8
   AND RHFP0401.EDICAO_NIVEL3 NOT IN ('013', '001')
 GROUP BY RHFP0401.EDICAO_ORG,
          RHFP0400.NOME_ORGANOGRAMA,
          TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MM/YYYY'),
          RHAF1123.ORIGEM
 ORDER BY RHFP0401.EDICAO_ORG ASC;


--===================--
--===================--





--SQL OCORRÊNCIAS INFORMADAS MANUALMENTE

SELECT DISTINCT RHAF1123.COD_CONTRATO,
                RHFP0401.EDICAO_ORG,
                RHFP0400.NOME_ORGANOGRAMA,
                RHAF1123.DATA_OCORRENCIA,
                TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MM/YYYY') AS MES_OCORRENCIA,
                RHAF1123.COD_OCORRENCIA,
                RHAF1129.NOME_OCORRENCIA,
                RHAF1123.ORIGEM,
                RHAF1123.NUM_HORAS,
                (TRIM(TO_CHAR(RHYF0118(RHAF1123.NUM_HORAS), '990,00'))) AS NUM_HORAS_HM
  FROM RHAF1123 RHAF1123,
       RHAF1129 RHAF1129,
       RHAF1138 RHAF1138,
       RHAF1108 RHAF1108,
       RHFP0310 RHFP0310,
       RHFP0400 RHFP0400,
       RHFP0401 RHFP0401
 WHERE RHAF1123.COD_OCORRENCIA = RHAF1129.COD_OCORRENCIA
   AND RHAF1123.COD_CONTRATO = RHAF1108.COD_CONTRATO(+)
   AND RHAF1123.COD_CONTRATO = RHFP0310.COD_CONTRATO
   AND RHFP0310.COD_ORGANOGRAMA = RHFP0400.COD_ORGANOGRAMA
   AND RHFP0400.COD_ORGANOGRAMA = RHFP0401.COD_ORGANOGRAMA
   AND RHAF1123.DATA_OCORRENCIA BETWEEN '01/05/2023' AND '31/05/2023'
   AND RHAF1123.DATA_OCORRENCIA BETWEEN RHAF1108.DATA_INICIO AND
       RHAF1108.DATA_FIM
   AND RHAF1129.COD_MOTIVO_OCO = RHAF1138.COD_MOTIVO_OCO(+)
   AND RHFP0310.DATA_FIM = '31/12/2999'
   AND RHAF1123.ORIGEM = 'I'
 ORDER BY RHAF1123.COD_CONTRATO ASC;

SELECT * FROM RHFP0401

--VERSÃO TOTALIZADORA POR FILIAL


SELECT RHFP0401.EDICAO_ORG,
       RHFP0400.NOME_ORGANOGRAMA,
       TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MM/YYYY') AS MES_OCORRENCIA,
       RHAF1123.ORIGEM,
       TO_CHAR(SUM(TRUNC(RHAF1123.NUM_HORAS)) +
               TRUNC(SUM((RHAF1123.NUM_HORAS - TRUNC(RHAF1123.NUM_HORAS)) * 60) / 60),
               'FM9900') || ':' ||
       TO_CHAR(MOD(SUM((RHAF1123.NUM_HORAS - TRUNC(RHAF1123.NUM_HORAS)) * 60),
                   60),
               'FM00') AS TOTAL_HORAS_HM
  FROM RHAF1123 RHAF1123
  JOIN RHAF1129 RHAF1129 ON RHAF1123.COD_OCORRENCIA =
                            RHAF1129.COD_OCORRENCIA
  LEFT JOIN RHAF1108 RHAF1108 ON RHAF1123.COD_CONTRATO =
                                 RHAF1108.COD_CONTRATO
  JOIN RHFP0310 RHFP0310 ON RHAF1123.COD_CONTRATO = RHFP0310.COD_CONTRATO
  JOIN RHFP0400 RHFP0400 ON RHFP0310.COD_ORGANOGRAMA =
                            RHFP0400.COD_ORGANOGRAMA
  JOIN RHFP0401 RHFP0401 ON RHFP0400.COD_ORGANOGRAMA =
                            RHFP0401.COD_ORGANOGRAMA
  LEFT JOIN RHAF1138 RHAF1138 ON RHAF1129.COD_MOTIVO_OCO =
                                 RHAF1138.COD_MOTIVO_OCO
 WHERE RHAF1123.DATA_OCORRENCIA BETWEEN '01/05/2023' AND '31/05/2023'
   AND RHAF1123.DATA_OCORRENCIA BETWEEN RHAF1108.DATA_INICIO AND
       RHAF1108.DATA_FIM
   AND RHFP0310.DATA_FIM = '31/12/2999'
   AND RHAF1123.ORIGEM = 'I'
   AND RHFP0401.COD_NIVEL2 = 8
   AND RHFP0401.EDICAO_NIVEL3 NOT IN ('013', '001')
 GROUP BY RHFP0401.EDICAO_ORG,
          RHFP0400.NOME_ORGANOGRAMA,
          TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MM/YYYY'),
          RHAF1123.ORIGEM
 ORDER BY RHFP0401.EDICAO_ORG ASC;


--===================--
--===================--





--SQL HORAS EXTRAS COM MAIS DE 10 HORAS TRABALHADAS

SELECT DISTINCT RHAF1123.COD_CONTRATO,
                RHFP0401.EDICAO_ORG,
                RHFP0400.NOME_ORGANOGRAMA,
                RHAF1123.DATA_OCORRENCIA,
                TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MM/YYYY') AS MES_OCORRENCIA,
                RHAF1123.COD_OCORRENCIA,
                RHAF1129.NOME_OCORRENCIA,
                RHAF1123.ORIGEM,
                RHAF1123.NUM_HORAS,
                (TRIM(TO_CHAR(RHYF0118(RHAF1123.NUM_HORAS), '990,00'))) AS NUM_HORAS_HM
  FROM RHAF1123 RHAF1123,
       RHAF1129 RHAF1129,
       RHAF1138 RHAF1138,
       RHAF1108 RHAF1108,
       RHFP0310 RHFP0310,
       RHFP0400 RHFP0400,
       RHFP0401 RHFP0401
 WHERE RHAF1123.COD_OCORRENCIA = RHAF1129.COD_OCORRENCIA
   AND RHAF1123.COD_CONTRATO = RHAF1108.COD_CONTRATO(+)
   AND RHAF1123.COD_CONTRATO = RHFP0310.COD_CONTRATO
   AND RHFP0310.COD_ORGANOGRAMA = RHFP0400.COD_ORGANOGRAMA
   AND RHFP0400.COD_ORGANOGRAMA = RHFP0401.COD_ORGANOGRAMA
   AND RHAF1123.DATA_OCORRENCIA BETWEEN '01/05/2023' AND '31/05/2023'
   AND RHAF1123.DATA_OCORRENCIA BETWEEN RHAF1108.DATA_INICIO AND
       RHAF1108.DATA_FIM
   AND RHAF1129.COD_MOTIVO_OCO = RHAF1138.COD_MOTIVO_OCO(+)
   AND RHFP0310.DATA_FIM = '31/12/2999'
   AND RHAF1123.COD_OCORRENCIA = 2
   AND RHAF1123.NUM_HORAS > 10
 ORDER BY RHAF1123.COD_CONTRATO ASC;


--VERSÃO TOTALIZADORA POR FILIAL

SELECT RHFP0401.EDICAO_ORG,
       RHFP0400.NOME_ORGANOGRAMA,
       TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MM/YYYY') AS MES_OCORRENCIA,
       RHAF1123.ORIGEM,
       TO_CHAR(SUM(TRUNC(RHAF1123.NUM_HORAS)) +
               TRUNC(SUM((RHAF1123.NUM_HORAS - TRUNC(RHAF1123.NUM_HORAS)) * 60) / 60),
               'FM9900') || ':' ||
       TO_CHAR(MOD(SUM((RHAF1123.NUM_HORAS - TRUNC(RHAF1123.NUM_HORAS)) * 60),
                   60),
               'FM00') AS TOTAL_HORAS_HM
  FROM RHAF1123 RHAF1123
  JOIN RHAF1129 RHAF1129 ON RHAF1123.COD_OCORRENCIA =
                            RHAF1129.COD_OCORRENCIA
  LEFT JOIN RHAF1108 RHAF1108 ON RHAF1123.COD_CONTRATO =
                                 RHAF1108.COD_CONTRATO
  JOIN RHAF1119 ON RHAF1123.COD_CONTRATO = RHAF1119.COD_CONTRATO
  JOIN RHAF1145 ON RHAF1119.COD_TURNO = RHAF1145.COD_TURNO
  JOIN RHFP0310 RHFP0310 ON RHAF1123.COD_CONTRATO = RHFP0310.COD_CONTRATO
  JOIN RHFP0400 RHFP0400 ON RHFP0310.COD_ORGANOGRAMA =
                            RHFP0400.COD_ORGANOGRAMA
  JOIN RHFP0401 RHFP0401 ON RHFP0400.COD_ORGANOGRAMA =
                            RHFP0401.COD_ORGANOGRAMA
  LEFT JOIN RHAF1138 RHAF1138 ON RHAF1129.COD_MOTIVO_OCO =
                                 RHAF1138.COD_MOTIVO_OCO
 WHERE RHAF1123.DATA_OCORRENCIA BETWEEN '01/05/2023' AND '31/05/2023'
   AND RHAF1123.DATA_OCORRENCIA BETWEEN RHAF1108.DATA_INICIO AND
       RHAF1108.DATA_FIM
   AND RHFP0310.DATA_FIM = '31/12/2999'
   AND RHAF1123.COD_OCORRENCIA = 2
   AND RHAF1123.NUM_HORAS > 10
   AND RHFP0401.COD_NIVEL2 = 8
   AND RHFP0401.EDICAO_NIVEL3 NOT IN ('013', '001')
 GROUP BY RHFP0401.EDICAO_ORG,
          RHFP0400.NOME_ORGANOGRAMA,
          TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MM/YYYY'),
          RHAF1123.ORIGEM
 ORDER BY RHFP0401.EDICAO_ORG ASC;


and a.cod_organograma_sub = 8
AND RHFP0401.EDICAO_NIVEL3  NOT IN ('013', '001')


--===================--
--===================--





--SQL INTERVALOS DE JORNADAS INFERIOR A 15 MIN (150 A 180)

SELECT DISTINCT RHAF1123.COD_CONTRATO,
                RHFP0401.EDICAO_ORG,
                RHFP0400.NOME_ORGANOGRAMA,
                RHAF1123.DATA_OCORRENCIA,
                TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MM/YYYY') AS MES_OCORRENCIA,
                RHAF1123.COD_OCORRENCIA,
                RHAF1129.NOME_OCORRENCIA,
                RHAF1123.ORIGEM,
                RHAF1123.NUM_HORAS,
                (TRIM(TO_CHAR(RHYF0118(RHAF1123.NUM_HORAS), '990,00'))) AS NUM_HORAS_HM
  FROM RHAF1123 RHAF1123,
       RHAF1129 RHAF1129,
       RHAF1138 RHAF1138,
       RHAF1108 RHAF1108,
       RHAF1119 RHAF1119,
       RHAF1145 RHAF1145,
       RHFP0310 RHFP0310,
       RHFP0400 RHFP0400,
       RHFP0401 RHFP0401
 WHERE RHAF1123.COD_OCORRENCIA = RHAF1129.COD_OCORRENCIA
   AND RHAF1123.COD_CONTRATO = RHAF1108.COD_CONTRATO(+)
   AND RHAF1123.COD_CONTRATO = RHAF1119.COD_CONTRATO
   AND RHAF1119.COD_TURNO = RHAF1145.COD_TURNO
   AND RHAF1123.COD_CONTRATO = RHFP0310.COD_CONTRATO
   AND RHFP0310.COD_ORGANOGRAMA = RHFP0400.COD_ORGANOGRAMA
   AND RHFP0400.COD_ORGANOGRAMA = RHFP0401.COD_ORGANOGRAMA
   AND RHAF1123.DATA_OCORRENCIA BETWEEN '01/05/2023' AND '31/05/2023'
   AND RHAF1123.DATA_OCORRENCIA BETWEEN RHAF1108.DATA_INICIO AND
       RHAF1108.DATA_FIM
   AND RHAF1129.COD_MOTIVO_OCO = RHAF1138.COD_MOTIVO_OCO(+)
   AND RHFP0310.DATA_FIM = '31/12/2999'
   AND RHAF1145.CARGA_HORARIA BETWEEN 165 AND 180
   AND RHAF1123.COD_OCORRENCIA = 2049
 ORDER BY RHAF1123.COD_CONTRATO ASC;


--VERSÃO TOTALIZADORA POR FILIAL

SELECT RHFP0401.EDICAO_ORG,
       RHFP0400.NOME_ORGANOGRAMA,
       TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MM/YYYY') AS MES_OCORRENCIA,
       RHAF1123.ORIGEM,
       TO_CHAR(SUM(TRUNC(RHAF1123.NUM_HORAS)) +
               TRUNC(SUM((RHAF1123.NUM_HORAS - TRUNC(RHAF1123.NUM_HORAS)) * 60) / 60),
               'FM9900') || ':' ||
       TO_CHAR(MOD(SUM((RHAF1123.NUM_HORAS - TRUNC(RHAF1123.NUM_HORAS)) * 60),
                   60),
               'FM00') AS TOTAL_HORAS_HM
  FROM RHAF1123 RHAF1123
  JOIN RHAF1129 RHAF1129 ON RHAF1123.COD_OCORRENCIA =
                            RHAF1129.COD_OCORRENCIA
  LEFT JOIN RHAF1108 RHAF1108 ON RHAF1123.COD_CONTRATO =
                                 RHAF1108.COD_CONTRATO
  JOIN RHAF1119 ON RHAF1123.COD_CONTRATO = RHAF1119.COD_CONTRATO
  JOIN RHAF1145 ON RHAF1119.COD_TURNO = RHAF1145.COD_TURNO
  JOIN RHFP0310 RHFP0310 ON RHAF1123.COD_CONTRATO = RHFP0310.COD_CONTRATO
  JOIN RHFP0400 RHFP0400 ON RHFP0310.COD_ORGANOGRAMA =
                            RHFP0400.COD_ORGANOGRAMA
  JOIN RHFP0401 RHFP0401 ON RHFP0400.COD_ORGANOGRAMA =
                            RHFP0401.COD_ORGANOGRAMA
  LEFT JOIN RHAF1138 RHAF1138 ON RHAF1129.COD_MOTIVO_OCO =
                                 RHAF1138.COD_MOTIVO_OCO
 WHERE RHAF1123.DATA_OCORRENCIA BETWEEN '01/05/2023' AND '31/05/2023'
   AND RHAF1123.DATA_OCORRENCIA BETWEEN RHAF1108.DATA_INICIO AND
       RHAF1108.DATA_FIM
   AND RHFP0310.DATA_FIM = '31/12/2999'
   AND RHAF1145.CARGA_HORARIA BETWEEN 165 AND 180
   AND RHAF1123.COD_OCORRENCIA = 2049
   AND RHFP0401.COD_NIVEL2 = 8
   AND RHFP0401.EDICAO_NIVEL3 NOT IN ('013', '001')
 GROUP BY RHFP0401.EDICAO_ORG,
          RHFP0400.NOME_ORGANOGRAMA,
          TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MM/YYYY'),
          RHAF1123.ORIGEM
 ORDER BY RHFP0401.EDICAO_ORG ASC;


--===================--
--===================--





--SQL OCORRÊNCIAS DE INTRAJORNADA INFERIORES A 11 H - AJUSTAR


SELECT DISTINCT RHAF1123.COD_CONTRATO,
                RHFP0401.EDICAO_ORG,
                RHFP0400.NOME_ORGANOGRAMA,
                RHAF1123.DATA_OCORRENCIA,
                TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MM/YYYY') AS MES_OCORRENCIA,
                RHAF1123.COD_OCORRENCIA,
                RHAF1129.NOME_OCORRENCIA,
                RHAF1123.ORIGEM,
                RHAF1123.NUM_HORAS,
                (TRIM(TO_CHAR(RHYF0118(RHAF1123.NUM_HORAS), '990,00'))) AS NUM_HORAS_HM
  FROM RHAF1123 RHAF1123,
       RHAF1129 RHAF1129,
       RHAF1138 RHAF1138,
       RHAF1108 RHAF1108,
       RHAF1119 RHAF1119,
       RHAF1145 RHAF1145,
       RHFP0310 RHFP0310,
       RHFP0400 RHFP0400,
       RHFP0401 RHFP0401
 WHERE RHAF1123.COD_OCORRENCIA = RHAF1129.COD_OCORRENCIA
   AND RHAF1123.COD_CONTRATO = RHAF1108.COD_CONTRATO(+)
   AND RHAF1123.COD_CONTRATO = RHAF1119.COD_CONTRATO
   AND RHAF1119.COD_TURNO = RHAF1145.COD_TURNO
   AND RHAF1123.COD_CONTRATO = RHFP0310.COD_CONTRATO
   AND RHFP0310.COD_ORGANOGRAMA = RHFP0400.COD_ORGANOGRAMA
   AND RHFP0400.COD_ORGANOGRAMA = RHFP0401.COD_ORGANOGRAMA
   AND RHAF1123.DATA_OCORRENCIA BETWEEN '01/01/2023' AND '31/05/2023'
   AND RHAF1123.DATA_OCORRENCIA BETWEEN RHAF1108.DATA_INICIO AND
       RHAF1108.DATA_FIM
   AND RHAF1129.COD_MOTIVO_OCO = RHAF1138.COD_MOTIVO_OCO(+)
   AND RHFP0310.DATA_FIM = '31/12/2999'
   AND RHAF1123.COD_OCORRENCIA = 901
 ORDER BY RHAF1123.COD_CONTRATO ASC;
 


--VERSÃO TOTALIZADORA POR FILIAL 


SELECT RHFP0401.EDICAO_ORG,
       RHFP0400.NOME_ORGANOGRAMA,
       TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MM/YYYY') AS MES_OCORRENCIA,
       RHAF1123.ORIGEM,
       TO_CHAR(SUM(TRUNC(RHAF1123.NUM_HORAS)) +
               TRUNC(SUM((RHAF1123.NUM_HORAS - TRUNC(RHAF1123.NUM_HORAS)) * 60) / 60),
               'FM9900') || ':' ||
       TO_CHAR(MOD(SUM((RHAF1123.NUM_HORAS - TRUNC(RHAF1123.NUM_HORAS)) * 60),
                   60),
               'FM00') AS TOTAL_HORAS_HM
  FROM RHAF1123 RHAF1123
  JOIN RHAF1129 RHAF1129 ON RHAF1123.COD_OCORRENCIA =
                            RHAF1129.COD_OCORRENCIA
  LEFT JOIN RHAF1108 RHAF1108 ON RHAF1123.COD_CONTRATO =
                                 RHAF1108.COD_CONTRATO
  JOIN RHAF1119 ON RHAF1123.COD_CONTRATO = RHAF1119.COD_CONTRATO
  JOIN RHAF1145 ON RHAF1119.COD_TURNO = RHAF1145.COD_TURNO
  JOIN RHFP0310 RHFP0310 ON RHAF1123.COD_CONTRATO = RHFP0310.COD_CONTRATO
  JOIN RHFP0400 RHFP0400 ON RHFP0310.COD_ORGANOGRAMA =
                            RHFP0400.COD_ORGANOGRAMA
  JOIN RHFP0401 RHFP0401 ON RHFP0400.COD_ORGANOGRAMA =
                            RHFP0401.COD_ORGANOGRAMA
  LEFT JOIN RHAF1138 RHAF1138 ON RHAF1129.COD_MOTIVO_OCO =
                                 RHAF1138.COD_MOTIVO_OCO
 WHERE RHAF1123.DATA_OCORRENCIA BETWEEN '01/01/2023' AND '31/05/2023'
   AND RHAF1123.DATA_OCORRENCIA BETWEEN RHAF1108.DATA_INICIO AND
       RHAF1108.DATA_FIM
   AND RHFP0310.DATA_FIM = '31/12/2999'
   AND RHAF1123.COD_OCORRENCIA = 901
   AND RHFP0401.COD_NIVEL2 = 8
   AND RHFP0401.EDICAO_NIVEL3 NOT IN ('013', '001')
 GROUP BY RHFP0401.EDICAO_ORG,
          RHFP0400.NOME_ORGANOGRAMA,
          TO_CHAR(RHAF1123.DATA_OCORRENCIA, 'MM/YYYY'),
          RHAF1123.ORIGEM
 ORDER BY RHFP0401.EDICAO_ORG ASC;