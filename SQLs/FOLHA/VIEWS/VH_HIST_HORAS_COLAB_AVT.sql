CREATE OR REPLACE VIEW VH_HIST_HORAS_COLAB_AVT AS
SELECT RHFP0307.COD_CONTRATO,
       RHFP0307.DATA_INICIO AS DATA_INI_HR,
       RHFP0307.DATA_FIM AS DATA_FIM_HR,
       RHFP0307.COD_HORAS_BASE,
       /*RHFP0321.QTD_HORBAS_MES,
       RHFP0321.QTD_HORBAS_SEM,
       RHFP0321.QTD_HORBAS_DIA,*/
       LTRIM(RTRIM(TRIM(TRAILING '.' FROM TRIM(TRAILING '0' FROM TO_CHAR(RHFP0321.QTD_HORBAS_MES, '9999999990.99'))))) AS HR_BASE_MES,
       LTRIM(RTRIM(TRIM(TRAILING '.' FROM TRIM(TRAILING '0' FROM TO_CHAR(RHFP0321.QTD_HORBAS_SEM, '9999999990.99'))))) AS HR_BASE_SEM,
       LTRIM(RTRIM(TRIM(TRAILING '.' FROM TRIM(TRAILING '0' FROM TO_CHAR(RHFP0321.QTD_HORBAS_DIA, '9999999990.99'))))) AS HR_BASE_DIA,
       RHFP0307.COD_MOTIVO,
       RHFP0323.NOME_MOTIVO AS DES_MOTIVO,
       RHFP0323.COD_TIPO_MOTIVO,
       RHFP0115.NOME_TIPO_MOTIVO AS DES_TIPO_MOTIVO
  FROM RHFP0321 RHFP0321,
       RHFP0307 RHFP0307,
       RHFP0323 RHFP0323,
       RHFP0115 RHFP0115
 WHERE RHFP0307.COD_HORAS_BASE = RHFP0321.COD_HORAS_BASE(+)
   AND RHFP0307.COD_MOTIVO = RHFP0323.COD_MOTIVO(+)
   AND RHFP0323.COD_TIPO_MOTIVO = RHFP0115.COD_TIPO_MOTIVO(+)
   --AND RHFP0307.COD_CONTRATO = 389622

