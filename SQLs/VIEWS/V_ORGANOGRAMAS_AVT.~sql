CREATE OR REPLACE VIEW V_ORGANOGRAMAS_AVT AS
SELECT
    L.COD_ORGANOGRAMA,
    L.COD_UNIDADE,
    L.DES_UNIDADE,
    L.DATA_INICIO,
    L.DATA_FIM,
    L.COD_NIVEL,
    L.COD_REDE,
    L.DES_REDE,
    L.COD_REGIAO,
    L.DES_REGIAO,
    L.COD_EMPRESA,
    L.DES_EMPRESA,
    TO_CHAR(L.COD_TIPO) AS COD_TIPO,
    L.DES_TIPO,
    L.TIPO_LOGRA,
    L.DES_TIP_LOGRA,
    L.COD_LOGRA,
    L.DES_LOGRA,
    TO_CHAR(L.NUMERO) AS NUMERO, -- Conversão da coluna NUMERO
    L.COD_BAIRRO,
    L.DES_BAIRRO,
    L.COD_CIDADE,
    L.DES_CIDADE,
    L.COD_UF,
    L.NUM_CNPJ,
    L.EDICAO_COMPLETA
FROM
    V_DADOS_LOJAS_AVT L

UNION ALL

-- Selecionando dados dos Setores
SELECT
    S.COD_ORGANOGRAMA,
    S.COD_SETOR,
    S.DES_SETOR,
    S.DATA_INICIO,
    S.DATA_FIM,
    S.COD_NIVEL,
    S.COD_REDE,
    S.DES_REDE,
    S.COD_REGIAO,
    S.DES_REGIAO,
    S.COD_EMPRESA,
    S.DES_EMPRESA,
    TO_CHAR(S.COD_TIPO) AS COD_TIPO, -- Garantindo que COD_TIPO também seja string, como no primeiro SELECT
    S.DES_TIPO,
    S.TIPO_LOGRA,
    S.DES_TIP_LOGRA,
    S.COD_LOGRA,
    S.DES_LOGRA,
    TO_CHAR(S.NUMERO) AS NUMERO, -- Conversão da coluna NUMERO
    S.COD_BAIRRO,
    S.DES_BAIRRO,
    S.COD_CIDADE,
    S.DES_CIDADE,
    S.COD_UF,
    S.NUM_CNPJ,
    S.EDICAO_COMPLETA
FROM
    V_SETORES_ADM_AVT S

